{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": ["schema_version", "last_updated", "metrics", "entities"],
  "properties": {
    "schema_version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Semantic version of schema (e.g., 1.0.0)"
    },
    "last_updated": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of last modification"
    },
    "metrics": {
      "type": "object",
      "description": "SYNCED FROM progress.json after every task",
      "required": ["total_rl_score", "tasks_completed"],
      "properties": {
        "total_rl_score": {"type": "number"},
        "tasks_completed": {"type": "integer", "minimum": 0},
        "tasks_failed": {"type": "integer", "minimum": 0},
        "commits": {"type": "integer", "minimum": 0}
      }
    },
    "entities": {
      "type": "array",
      "description": "TOP-APPEND MANDATORY: Newest entity MUST be at [0]. Knowledge graph nodes.",
      "items": {
        "type": "object",
        "required": ["name", "entityType", "observations"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Unique identifier for entity (e.g., John_Smith)",
            "pattern": "^[A-Za-z0-9_]+$"
          },
          "entityType": {
            "type": "string",
            "description": "Type of entity",
            "enum": [
              "person",
              "organization",
              "event",
              "project",
              "technology",
              "concept",
              "location",
              "tool",
              "pattern",
              "error",
              "solution"
            ]
          },
          "observations": {
            "type": "array",
            "description": "Discrete facts about this entity",
            "items": {
              "type": "string",
              "minLength": 1,
              "maxLength": 500
            }
          }
        }
      }
    },
    "relations": {
      "type": "array",
      "description": "Directed connections between entities (active voice)",
      "items": {
        "type": "object",
        "required": ["from", "to", "relationType"],
        "properties": {
          "from": {
            "type": "string",
            "description": "Source entity name",
            "pattern": "^[A-Za-z0-9_]+$"
          },
          "to": {
            "type": "string",
            "description": "Target entity name",
            "pattern": "^[A-Za-z0-9_]+$"
          },
          "relationType": {
            "type": "string",
            "description": "Type of relationship in active voice",
            "enum": [
              "works_at",
              "manages",
              "uses",
              "knows",
              "created",
              "depends_on",
              "implements",
              "resolves",
              "caused_by",
              "related_to",
              "part_of",
              "similar_to",
              "replaces",
              "extends"
            ]
          }
        }
      }
    }
  }
}
